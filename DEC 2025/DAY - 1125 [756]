** 756. Pyramid Transition Matrix **

# Approach 1:
class Solution:
    def pyramidTransition(self, bottom: str, allowed: List[str]) -> bool:
        @cache
        def dfs(level: str) -> bool:
            if len(level) == 1:
                return True

            return any(
                dfs(next_level)
                for next_level in product(*(pool[x + y] for x, y in pairwise(level)))
            )

        pool = defaultdict(list)

        for pattern in allowed:
            pool[pattern[:2]].append(pattern[2])

        return dfs(bottom)

# Approach 2:
class Solution:
    def pyramidTransition(self, bottom: str, allowed: List[str]) -> bool:
        pdic = defaultdict(list)
        for patt in allowed: pdic[patt[:2]].append(patt[2:])

        @cache
        def isgood(line):
            stack = ['z']*(len(line) -1)
            def nextline(depth):
                if  depth==len(stack):  return isgood(''.join(stack))
                for cube in pdic[line[depth] + line[depth+1]]:
                    stack[depth] = cube
                    if  nextline(depth+1):  return True
                return False
            return True if len(line) < 2  else nextline(0)
        return isgood(bottom)
